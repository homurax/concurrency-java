# 使用并行流处理大规模数据集：MapReduce 模型

Java 8 引入的最重要的创新是 lambda 表达式和流 API。流是可以以顺序方式或者并行 方式处理的一个元素序列。可以应用中间操作转换流，然后执行最终计算以获得预期结果。



## 流的简介

流就是一个数据序列（并不是一种数据结构），可以以顺序方式或者并发方式应用某一操作序列来筛选、转换、排序、约简（reduce）或组织这些元素，以获得某一最终对象。



### 流的基本特征

- 流并不存储其元素。
- 可以以并行方式处理流而无须做任何额外工作。`stream()`、`parallelStream()` 。
- 流不可重用。
- 流可对数据做延迟处理。
- 不能以不同方式访问流的元素。流操作通常对元素做统一处理，因此有的只有元素本身。无法知道元素在流中的位置及其相邻元素。
- 流操作并不允许修改流的源。



### 流的组成部分

- 生成供流使用的数据的来源。
- 0 个或者多个中间操作，这些操作产生另一个流作为输出。
- 生成对象的末端操作，该对象可以是一个简单对象，也可以是一个类似数组、列表或者哈希表的 Collection。也可以存在不产生任何显式结果的末端操作。



1. 流的来源

   流的来源可产生将由 Stream 对象处理的数据。可从多个数据源创建一个流。

   Collection 接口包括了生成顺序流的 `stream()` 方法，以及生成并行流的 `parallelStream()` 方法。

   Array 类含有四种版本可从数组产生流的 `stream()` 方法。

   Stream 接口提供了 `generate()` 方法和 `iterate()` 方法。

2. 中间操作

   中间操作最重要的特征在于它将另一个流作为结果返回。输入流和输出流的对象可以是不同类型的，但是中间操作总可以生成新流。

   `distinct()`、`filter()`、`flatMap()`、`limit()`、`map()`、`peek()`、`skip()`、`sorted()`

3. 末端操作

   末端操作将某个对象作为结果返回，而绝不会返回一个流。一般来说，所有流都会以一个末端操作结束，而该末端操作返回的是整个操作序列的最终结果。

   `collect`、`count`、`max`、`min`、`reduce`、`forEach`、`forEachOrdered`、`findFirst`、`findAny`、`anyMatch`、`allMatch`、`noneMatch`、`toArray`







